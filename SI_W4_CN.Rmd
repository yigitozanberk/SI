---
title: "Week 4 Classnotes"
author: "Yigit Ozan Berk"
date: "6/21/2019"
output: html_document
---

# Power = 1 - Type II error rate

We've talked about a Type I error, rejecting the null hypothesis when it's true. We've structured our hypothesis test so that the probability of this happening is small. The other kind of error we could make is to fail to reject when the alternative is true (Type II error). Or we might think about the probability of rejecting the null when it is false. This is called Power = 1 - Type II error. We don't have as much control over this probability, since we've spent all of our flexibility guaranteeing that the Type I error rate is small.

One avenue for the control of power is at the design phase. There, assuming our finances let us, we can pick a large enough sample size so that we'd be likely to reject if the alternative is true. Thus the most frequent use of power is to help us design studies.


# Contents

- Power
- Multipe Comparisons
- Resampling
- Quiz
- Course Project
- Swirl Excercises

# Power

power is the probability of rejecting the null hypothesis when it is false.

```{r}
z <- qnorm(1 - alpha)
pnorm(mu0 + z * sigma/sqrt(n), mean = mua, sd = sigma/sqrt(n), lower.tail = FALSE)
```


As you collect more and more sample for data, the power increases faster.

```{r}
library(manipulate)
library(ggplot2)
mu0 <- 30
#alpha is Type I error rate
myplot <- function(sigma, mua, n, alpha) {
        g <- ggplot(data.frame(mu = c(27, 36)), aes(x = mu))
        g <- g + stat_function(fun= dnorm, geom = "line",
                               args = list(mean = mu0, sd = sigma/sqrt(n)),
                               size = 2, col = "red")
        g <- g + stat_function(fun = dnorm, geom  = "line",
                               args = list(mean = mua, sd = sigma/sqrt(n)),
                               size = 2, col = "blue")
        xitc = mu0 + qnorm(1- alpha)*sigma/sqrt(n)
        g <- g + geom_vline(xintercept = xitc, size = 3)
        g
}

manipulate(
        myplot(sigma, mua, n, alpha),
        sigma = slider(1, 10, step = 1, initial = 4),
        mua = slider(30, 35, step = 1, initial = 32),
        n = slider(1, 50, step = 1, initial = 16),
        alpha = slider(0.01, 0.1, step = 0.01, initial = 0.05)
)

```

- power goes up as alpha gets larger
- power of a one sided test is greater than the power of the associated two sided test(alpha/2)
- power goes up as mu1 gets further away from mu0
- power goes up as n goes up

# T-test power

delta equals mua - mu0
delta = mua - mu0

```{r}
power.t.test(n = 16, delta = 2/4, sd = 1, type = "one.sample", alt = "one.sided")$power

```

```{r}
power.t.test(n = 16, delta = 2, sd = 4, type = "one.sample", alt = "one.sided")$power
```

```{r}
power.t.test(n = 16, delta = 100, sd = 200, type = "one.sample", alt = "one.sided")$power
```

because we keep delta/sd same, the output is equivalent

let's try to calculate sample size

```{r}
power.t.test(power = 0.8, delta = 2/4, sd = 1, type = "one.sample", alt = "one.sided")$n
```

```{r}
power.t.test(power = 0.8, delta = 2, sd = 4, type = "one.sample", alt = "one.sided")$n
```

```{r}
power.t.test(power = 0.8, delta = 100, sd = 200, type = "one.sample", alt = "one.sided")$n
```

